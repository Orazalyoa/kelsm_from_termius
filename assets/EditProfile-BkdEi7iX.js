import{_ as L}from"./_plugin-vue_export-helper-BgbHP9iJ.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{V as Q,r,c as V,e as R,P as h,Q as _,j as d,W as e,a4 as W,Y as l,u as n,Z as u,s as y,a2 as g,B as C,F as X,X as Y,y as Z}from"./vue-vendor-DEVBTxx0.js";import{u as q,b as G}from"./index-tPAe9Dy4.js";import{u as H}from"./useUpload-D_KmIuvU.js";import{h as F}from"./errorHandler-D1LKPKx3.js";import{C as J}from"./CustomNavBar-BJGtUQrX.js";import{Button as K,Form as O,Popover as ee,Popup as oe,Image as te,showLoadingToast as ae,showSuccessToast as I}from"./vant-CoNmWDyF.js";import"./index_logo-B4Lpufyb.js";const se={class:"edit-profile-page"},le={class:"avatar-section"},ne={key:1,class:"avatar-placeholder"},ie={class:"form-field"},re={class:"field-label"},ce=["placeholder"],de={class:"form-field"},ue={class:"field-label"},pe=["placeholder"],fe={class:"form-field"},me={class:"field-label"},_e={class:"form-field"},ve={class:"field-label"},he=["placeholder"],ye={class:"button-container"},ge={class:"phone-edit-popup"},ke={class:"popup-header"},be={class:"popup-title"},we={class:"phone-edit-content"},Ce={class:"phone-input-wrapper"},xe={class:"country-code"},Be={class:"country-code-text"},Pe={class:"country-list-popup"},Ue=["onClick"],Ve={class:"country-flag"},Fe={class:"country-name"},Ie={class:"country-code-text"},Se=["placeholder"],Ae={__name:"EditProfile",setup(De){const S=Q(),{t:o}=q(),p=G(),{compressImage:A}=H(),k=r(!1),f=r(!1),b=r(!1),x=r(null),i=r({first_name:"",last_name:"",email:"",phone:"",country_code:"+7"}),v=r(""),m=r({code:"+7",name:o("countries.russia"),flag:"ðŸ‡·ðŸ‡º"}),B=r([{code:"+7",name:o("countries.russia"),flag:"ðŸ‡·ðŸ‡º"},{code:"+7",name:o("countries.kazakhstan"),flag:"ðŸ‡°ðŸ‡¿"},{code:"+1",name:o("countries.usa"),flag:"ðŸ‡ºðŸ‡¸"},{code:"+86",name:o("countries.china"),flag:"ðŸ‡¨ðŸ‡³"},{code:"+44",name:o("countries.uk"),flag:"ðŸ‡¬ðŸ‡§"},{code:"+49",name:o("countries.germany"),flag:"ðŸ‡©ðŸ‡ª"},{code:"+33",name:o("countries.france"),flag:"ðŸ‡«ðŸ‡·"},{code:"+81",name:o("countries.japan"),flag:"ðŸ‡¯ðŸ‡µ"},{code:"+82",name:o("countries.korea"),flag:"ðŸ‡°ðŸ‡·"},{code:"+91",name:o("countries.india"),flag:"ðŸ‡®ðŸ‡³"}]),P=V(()=>p.userAvatar),D=V(()=>i.value.phone?`${i.value.country_code} ${i.value.phone}`:""),U=()=>{x.value.click()},N=async s=>{const t=s.target.files[0];if(t){try{ae({message:o("profile.uploading"),forbidClick:!0});const c=await A(t);await p.uploadAvatar(c),I(o("profile.upload_success"))}catch(c){F(c,o("profile.upload_failed"))}s.target.value=""}},T=s=>{m.value=s,b.value=!1},$=()=>{i.value.country_code=m.value.code,i.value.phone=v.value,f.value=!1},E=async()=>{k.value=!0;try{await p.updateProfile(i.value),I(o("profile.save_success")),setTimeout(()=>S.back(),1500)}catch(s){F(s,o("profile.save_failed"))}finally{k.value=!1}};return R(()=>{if(p.user){const s=p.user;if(i.value={first_name:s.first_name||"",last_name:s.last_name||"",email:s.email||"",phone:s.phone||"",country_code:s.country_code||"+7"},s.phone&&(v.value=s.phone),s.country_code){const t=B.value.find(c=>c.code===s.country_code);t&&(m.value=t)}}}),(s,t)=>{const c=te,w=K,M=O,j=ee,z=oe;return _(),h("div",se,[d(J,{title:"","show-logo":!0,"show-bell":!0}),e("div",le,[e("div",{class:"avatar-wrapper",onClick:U},[P.value?(_(),W(c,{key:0,src:P.value,round:"",width:"100",height:"100",fit:"cover"},null,8,["src"])):(_(),h("div",ne,[...t[8]||(t[8]=[e("svg",{width:"60",height:"60",viewBox:"0 0 60 60",fill:"none"},[e("circle",{cx:"30",cy:"20",r:"12",fill:"#B8D8F0"}),e("path",{d:"M10 55C10 42 18 35 30 35C42 35 50 42 50 55",fill:"#B8D8F0"})],-1)])]))]),e("div",{class:"change-avatar-link",onClick:U},l(n(o)("profile.change_photo")),1)]),d(M,{onSubmit:E,class:"profile-form"},{default:u(()=>[e("div",ie,[e("label",re,l(n(o)("profile.last_name")),1),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>i.value.last_name=a),type:"text",placeholder:n(o)("profile.enter_last_name"),class:"field-input"},null,8,ce),[[g,i.value.last_name]])]),e("div",de,[e("label",ue,l(n(o)("profile.first_name")),1),y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>i.value.first_name=a),type:"text",placeholder:n(o)("profile.enter_first_name"),class:"field-input"},null,8,pe),[[g,i.value.first_name]])]),e("div",fe,[e("label",me,l(n(o)("profile.phone")),1),e("div",{class:"field-input",onClick:t[2]||(t[2]=a=>f.value=!0)},l(D.value||n(o)("profile.enter_phone")),1)]),e("div",_e,[e("label",ve,l(n(o)("profile.email")),1),y(e("input",{"onUpdate:modelValue":t[3]||(t[3]=a=>i.value.email=a),type:"email",placeholder:n(o)("profile.enter_email"),class:"field-input"},null,8,he),[[g,i.value.email]])]),e("div",ye,[d(w,{type:"primary",block:"",round:"","native-type":"submit",loading:k.value,class:"submit-btn"},{default:u(()=>[C(l(n(o)("profile.save_and_update")),1)]),_:1},8,["loading"])])]),_:1}),d(z,{show:f.value,"onUpdate:show":t[7]||(t[7]=a=>f.value=a),position:"bottom",round:""},{default:u(()=>[e("div",ge,[e("div",ke,[d(w,{text:"",onClick:t[4]||(t[4]=a=>f.value=!1)},{default:u(()=>[C(l(n(o)("common.cancel")),1)]),_:1}),e("span",be,l(n(o)("profile.edit_phone")),1),d(w,{text:"",type:"primary",onClick:$},{default:u(()=>[C(l(n(o)("common.confirm")),1)]),_:1})]),e("div",we,[e("div",Ce,[d(j,{show:b.value,"onUpdate:show":t[5]||(t[5]=a=>b.value=a),placement:"bottom-start"},{reference:u(()=>[e("div",xe,[e("span",Be,l(m.value.code),1),t[9]||(t[9]=e("span",{class:"dropdown-icon"},"â–¼",-1))])]),default:u(()=>[e("div",Pe,[(_(!0),h(X,null,Y(B.value,a=>(_(),h("div",{key:a.code,class:Z(["country-item",{selected:a.code===m.value.code}]),onClick:Ne=>T(a)},[e("span",Ve,l(a.flag),1),e("span",Fe,l(a.name),1),e("span",Ie,l(a.code),1)],10,Ue))),128))])]),_:1},8,["show"]),y(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>v.value=a),type:"tel",placeholder:n(o)("profile.enter_phone"),class:"phone-input",maxlength:"15"},null,8,Se),[[g,v.value]])])])])]),_:1},8,["show"]),e("input",{ref_key:"avatarInput",ref:x,type:"file",accept:"image/*",style:{display:"none"},onChange:N},null,544)])}}},qe=L(Ae,[["__scopeId","data-v-1934b9e2"]]);export{qe as default};
