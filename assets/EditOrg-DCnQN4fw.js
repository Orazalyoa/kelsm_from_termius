import{_ as w}from"./_plugin-vue_export-helper-BgbHP9iJ.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{V as x,r as p,e as U,P as O,Q as k,j as r,W as h,u as l,Z as c,B as q,Y as B}from"./vue-vendor-DEVBTxx0.js";import{u as E,b as S,j as _}from"./index-tPAe9Dy4.js";import{h as f}from"./errorHandler-D1LKPKx3.js";import{a as T,u as C}from"./organization-CXFvl_zb.js";import{C as D}from"./CustomNavBar-BJGtUQrX.js";import{CellGroup as N,Field as I,Button as R,Form as j,showSuccessToast as A}from"./vant-CoNmWDyF.js";import"./index_logo-B4Lpufyb.js";const F={class:"edit-org-page"},G={class:"main-content"},M={class:"button-container"},P={__name:"EditOrg",setup(Q){const m=x(),{t:e}=E(),s=S(),u=p(!1),a=p({company_name:"",bin:"",contact_name:"",phone:"",email:"",description:""}),d=p(null),g=t=>t?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?!0:e("validation.email_invalid"):!0,b=async()=>{if(!d.value){_(e("common.missing_id"));return}u.value=!0;try{const t={name:a.value.company_name,company_id:a.value.bin,contact_name:a.value.contact_name||null,phone:a.value.phone||null,email:a.value.email||null,description:a.value.description||null};await C(d.value,t),await s.fetchUserOrganizations(),A(e("profile.save_success")),setTimeout(()=>m.back(),1500)}catch(t){f(t,e("profile.save_failed"))}finally{u.value=!1}},v=async()=>{if(!s.isCompanyAdmin){_(e("company.only_admin_can_edit")),setTimeout(()=>m.back(),1500);return}u.value=!0;try{if(s.organizations&&s.organizations.length>0){const t=s.organizations[0];d.value=t.id;const o=await T(t.id),n=o.organization||o.data||o;a.value={company_name:n.name||"",bin:n.company_id||n.bin||"",contact_name:n.contact_name||"",phone:n.phone||"",email:n.email||"",description:n.description||""}}else await s.fetchUserOrganizations(),s.organizations&&s.organizations.length>0?await v():(_(e("company.no_organization")),setTimeout(()=>m.back(),1500))}catch(t){f(t,e("common.data_load_failed"))}finally{u.value=!1}};return U(()=>{v()}),(t,o)=>{const n=I,y=N,V=R,z=j;return k(),O("div",F,[r(D,{title:l(e)("profile.edit_company"),"show-logo":!1},null,8,["title"]),h("div",G,[r(z,{onSubmit:b},{default:c(()=>[r(y,null,{default:c(()=>[r(n,{modelValue:a.value.company_name,"onUpdate:modelValue":o[0]||(o[0]=i=>a.value.company_name=i),label:l(e)("auth.company_name"),placeholder:l(e)("auth.company_name_placeholder"),required:"",rules:[{required:!0,message:l(e)("validation.company_name_required")}]},null,8,["modelValue","label","placeholder","rules"]),r(n,{modelValue:a.value.bin,"onUpdate:modelValue":o[1]||(o[1]=i=>a.value.bin=i),label:l(e)("auth.bin"),placeholder:l(e)("auth.bin_placeholder"),required:"",rules:[{required:!0,message:l(e)("validation.bin_required")}]},null,8,["modelValue","label","placeholder","rules"]),r(n,{modelValue:a.value.contact_name,"onUpdate:modelValue":o[2]||(o[2]=i=>a.value.contact_name=i),label:l(e)("company.contact_person"),placeholder:l(e)("auth.full_name_placeholder")},null,8,["modelValue","label","placeholder"]),r(n,{modelValue:a.value.phone,"onUpdate:modelValue":o[3]||(o[3]=i=>a.value.phone=i),type:"tel",label:l(e)("auth.phone_number"),placeholder:l(e)("auth.phone_number_placeholder")},null,8,["modelValue","label","placeholder"]),r(n,{modelValue:a.value.email,"onUpdate:modelValue":o[4]||(o[4]=i=>a.value.email=i),type:"email",label:l(e)("auth.email"),placeholder:l(e)("auth.email_placeholder"),rules:[{validator:g}]},null,8,["modelValue","label","placeholder","rules"]),r(n,{modelValue:a.value.description,"onUpdate:modelValue":o[5]||(o[5]=i=>a.value.description=i),type:"textarea",label:l(e)("company.description"),placeholder:l(e)("company.description_placeholder"),rows:"3",maxlength:"500","show-word-limit":""},null,8,["modelValue","label","placeholder"])]),_:1}),h("div",M,[r(V,{type:"primary",block:"",round:"","native-type":"submit",loading:u.value},{default:c(()=>[q(B(l(e)("profile.save_changes")),1)]),_:1},8,["loading"])])]),_:1})])])}}},ne=w(P,[["__scopeId","data-v-709781b0"]]);export{ne as default};
